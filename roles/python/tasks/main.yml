---
- name: Install pip
  apt:
    name : "{{ python_version }}-pip"
    state: present

# - name: Add key for jonathonf PPA
#   apt_key:
#     keyserver: keyserver.ubuntu.com
#     id: 4AB0F789CBA31744CC7DA76A8CF63AD3F06FC659
#     state: present

# - name: Add jonathonf PPA
#   apt_repository:
#     repo: deb http://ppa.launchpad.net/jonathonf/python-3.7/ubuntu bionic main
#     state: present

# - name: Install Python 3.7
#   apt:
#     name: python3.7
#     state: present
#     update_cache: yes

# - name: update .bash_aliases
#   become_user: vagrant
#   lineinfile:
#     dest: "{{ home_directory }}/.bash_aliases"
#     line: 'alias p3="python3.7"'
#     mode: 0644
#     state: present
#     create: yes

- name: upgrade pip
  pip:
    name: pip
    executable: "{{ pip_version }}"
    extra_args: --upgrade

- name: remove apt pip
  apt:
    name: "{{ python_version }}-pip"
    state: absent

- name: Set up global requirements
  pip:
    requirements: /vagrant/ansible_requirements.txt
    executable: "{{ pip_version }}"

- name: set up aliases
  blockinfile:
    dest: "{{ home_directory }}/.bash_aliases"
    insertafter: EOF
    state: present
    create: yes
    block: |
      # Shortcuts for the project
      alias activate="cd $HOME/app; workon {{ project_name }}"
      alias runserver="activate; python manage.py runserver 0.0.0.0:8000"
      alias shell="activate; python manage.py shell"
